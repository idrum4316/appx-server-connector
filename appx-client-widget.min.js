/*********************************************************************
 **
 **   server/appx-client-widget.js - Client Widget processing
 **
 **   This module contains code to process Appx Widget screen elements.
 **
 *********************************************************************/
"use strict"
function sanitizeText(e,t){if(null==e)return e
var a=$("<div>")
return t?e:null==t&&e.substring(0,6).toLowerCase().startsWith("<html>")?e:a.text(e).html()}function addClientId(e,t){return t&&t!=e?(appx_session.clientIds[e]=t,appx_session.clientIds[t]=e):appx_session.clientIds[e]=e,appx_session.clientIds[e]}function getClientId(e){return appx_session.clientIds[e]}function clearClientIds(){appx_session.clientIds={}}function eventCatcher(e){return e=e||e.originalEvent||window.event,e.preventDefault&&e.preventDefault(),e.stopPropagation&&e.stopPropagation(),!1}function appxwidgetcallback2(e){if(appx_session.mouseX){var t=Math.floor(appx_session.mouseY/appx_session.rowHeightPx),a=Math.floor(appx_session.mouseX/appx_session.colWidthPx)
appxPutCursor(a,t)}appxwidgetcallback(e)}function appxwidgetcallback(e){if(null===appx_session.objFocus){if(274!==e&&330!==e&&304!==e||(appx_session.scan=!1,appxClearScanCursor()),appx_session.lastOption=e,$(".appxtablewidget").length>0&&$(".appxtablewidget").data("action").command===e&&(appx_session.rowCallback=!0),"function"==typeof appx_session.optionOverride[e]){var t=appx_session.optionOverride[e]()
if(t)return}logca("appxwidgetcallback: "+e)
for(var a in CKEDITOR.instances){var s=$("#cke_"+a),o=$("#"+a).attr("maxLength")
if(CKEDITOR.instances[a].getData().length>o)return void appxSetStatusText("Error - Html Editor has more characters than the maximum allowed characters",2)}for(var a in CKEDITOR.instances){var s=$("#cke_"+a)
s.val(CKEDITOR.instances[a].getData()),CKEDITOR.instances[a].checkDirty()&&(s.addClass("appxitem dirty"),s.attr("id",a))}var i=[]
$("#appx_main_container").focus(),$(".dirty").each(function(){i.push(this)}),1==appx_session.processhelp&&(appx_session.processhelpoption=e,e=OPT_HELP_OPT),sendappxshow(e,i)}}function appxwidgetdimensions(e,t,a){try{var s,o,i,l=0,n=0,r=0,p=0,w=e,d=appx_session.colWidthPx,c=appx_session.rowHeightPx
if(s=w.hasOwnProperty("widget")?w.widget.wWidgetType:w.wWidgetType,a&&(l=a.begin_column-1,n=a.begin_row,appxIsScrollReg(a)||n--),w.hasOwnProperty("wWidgetId")||(e.hasOwnProperty("widget")&&null!=e.widget&&null!=e.widget.wPositionX?(w=e.widget,s!=WIDGET_TYPE_PROGRESS_BAR&&s!=WIDGET_TYPE_SLIDER&&(w.wSizeW||(w.wSizeW=e.size_col||e.size_cols),w.wSizeH||(w.wSizeH=e.size_row||e.size_rows))):(l=w.pos_col*d,n=w.pos_row*c,r=(w.size_cols||w.size_col)*d,p=(w.size_rows||w.size_row)*c)),w.hasOwnProperty("wWidgetId")){var g=0,h=0,T=0,u=0
w.wOffsetX&&(g=~~(w.wOffsetX*d/100)),w.wOffsetY&&(h=~~(w.wOffsetY*c/100)),w.wOffsetW&&(T=~~(w.wOffsetW*d/100)),w.wOffsetH&&(u=~~(w.wOffsetH*c/100)),null!=w.wPositionX&&(l=w.wPositionX?(w.wPositionX-l)*d+g:0,n=w.wPositionY?(w.wPositionY-n)*c+h:0,r=w.wSizeW?w.wSizeW*d+T:0,p=w.wSizeH?w.wSizeH*c+u:0)}if(t){o=e.pos_row,i=e.pos_col
parseInt(t.css("top").substring(0,t.css("top").indexOf("p")))
if(a&&(appxIsScrollReg(a)||appxIsScroll(a))){var x=(o-a.begin_row)*appx_session.rowHeightPx,b=(i-a.begin_column)*appx_session.colWidthPx
n=x,l=b,w.hasOwnProperty("wWidgetId")&&(w.wOffsetX&&(l+=~~(w.wOffsetX*appx_session.colWidthPx/100)),w.wOffsetY&&(n+=~~(w.wOffsetY*appx_session.rowHeightPx/100)))}if(t.css({position:"absolute",left:l,top:n}),s===WIDGET_TYPE_LINE||0!==p&&0!==r||t.hide(),s==WIDGET_TYPE_HTML_VIEWER&&(p-=2),t.css("height",p),s!=WIDGET_TYPE_CHECK_BOX){if(s!=WIDGET_TYPE_TABLE&&s!=WIDGET_TYPE_BOX&&s!=WIDGET_TYPE_BUTTON&&s!=WIDGET_TYPE_LABEL&&s!=WIDGET_TYPE_PICTURE&&s!=WIDGET_TYPE_LISTBOX&&(r+=5),s==WIDGET_TYPE_LISTBOX||w.wWidgetOriginalType==WIDGET_TYPE_LISTBOX){var _=3.96*d
t.attr("data-padWidth",_),r+=_,s==WIDGET_TYPE_RAW_TEXT&&w.wWidgetOriginalType==WIDGET_TYPE_LISTBOX&&(r-=5)}t.hasClass("button")&&t.hasClass("error")&&(r=315),t.css("width",r)}s==WIDGET_TYPE_BOX&&(w.wLabel&&w.wLabel.length>0?t.css({width:r-2*d-2+14,height:p-c+5+14,left:l+2}):t.css({width:r-2*d+2+14,height:p-c+5+2+14})),t.hasClass("defaultBorder")&&t.is("button")&&w.wBorder!=BORDER_NONE&&t.css({top:dim.y+1,left:dim.x+1,height:dim.h-2,width:dim.w-2})}}catch(E){console.log("appxwidgetdimensions: "+E),console.log(E.stack)}return{x:l,y:n,w:r,h:p,cw:d,rh:c}}function appxwidgetshandler(e){for(var t=e.data,a=1,s=!1;t.length>0;){var o=t.shift(),i=new Widget(o[0],"",o[1],o[2],o[3]),l=parseInt(i.wWidgetType)
if(i.wLabel=sanitizeText(i.wLabel,null),i.wDefaultButton&&(s?i.wDefaultButton=null:s=!0),l!=WIDGET_TYPE_ROWTEXT){var n=null
if("function"!=typeof appx_session.createWidgetTag[l]){var r=appx_session.createWidgetTag["default"](i,n)
n=r.tag,i=r.widget,l=i.wWidgetType}else n=appx_session.createWidgetTag[l](i,n)
n.data("row",i.wPositionY),n.data("col",i.wPositionX),n.data("parent_type",WIDGET_PRNT_TYPE_WIDGET),null!=n&&(appxwidgetdimensions(i,n),appxwidgetshandlerprops(i,n),n.addClass("appxwidget"),n.css("z-index",1e3+i.wLayer*-1),appx_session.widgets.push([i,n])),a++}else{var p=new RowTextStruct
p.type=ROWTEXT_TYPE_WIDGET,p.boxid=o[0],p.isTitle=i.wInvert,p.pos_row=i.wPositionY,p.pos_col=i.wPositionX,p.size_rows=i.wSizeH,p.size_cols=i.wSizeW,p.string=i.wLabel,appx_session.rowtext.push(p)}}}function appxTableColumnWidgetHandler(e){var t=new Widget(0,"",e,null,null),a=parseInt(t.wWidgetType)
t.wLabel=sanitizeText(t.wLabel,null)
var s=null
if("function"!=typeof appx_session.createWidgetTag[a]){var o=appx_session.createWidgetTag["default"](t,s)
s=o.tag,t=o.widget,a=t.wWidgetType}else s=appx_session.createWidgetTag[a](t,s)
return s.data("parent_type",WIDGET_PRNT_TYPE_WIDGET),null!=s&&(t.wPositionX=1,t.wPositionY=1,appxwidgetdimensions(t,s)),{tag:s,widget:t}}function appxTableRowWidgetHandler(e){return new Widget(0,"",e,null,null)}function appxTableApplyColumnStyle(e,t){if(e.wColorBg&&t.parent().css("background",e.wColorBg),e.wColorBgNL&&t.parent().css("opacity",e.wColorBgNL),e.wColorBgRollover||e.wColorBgRolloverNL||e.wColorFgRollover||e.wColorFgRolloverNL||e.wIconRollover){if(e.wIconRollover){t.addClass(AppxResource.load(e.wIconRollover)+"_imgRO")
var a=function(){var e=$img.attr("src"),a=t.attr("srcRO")
void 0!=e&&void 0!=a&&(t.attr("srcRO",e),$img.attr("src",a))}}t.mouseenter(function(){e.wColorBgRollover&&t.parent().css("background",e.wColorBgRollover),e.wColorBgRolloverNL&&t.parent().css("opacity",e.wColorBgRolloverNL),e.wColorFgRollover&&t.css("color",e.wColorFgRollover),e.wColorFgRolloverNL&&t.css("opacity",e.wColorFgRolloverNL),e.wIconRollover&&a()}).mouseleave(function(){e.wColorBgRollover&&t.parent().css("background",e.wColorBg?e.wColorBg:""),e.wColorBgRolloverNL&&t.parent().css("opacity",e.wColorBgNL?e.wColorBgNL:1),e.wColorFgRollover&&t.css("color",e.wColorFg?e.wColorFg:""),e.wColorFgRolloverNL&&t.css("opacity",e.wColorFgNL?e.wColorFgNL:1),e.wIconRollover&&a()})}if(e.wColorFg&&(t.css("color",e.wColorFg),e.wColorFgNL&&t.css("opacity",e.wColorFgNL)),e.wFont){var s=null
switch(e.wFont){case"helvetica":s=bInput?"default-input":"default"
break
case"Courier":s="courier"
break
case"Helvetica":s="arial"
break
case"TimesRoman":s="times-roman"
break
case"Dialog":s="fixed-sys"
break
case"DialogInput":s="terminal"
break
case"ZapfDingbats":s="wingdings"
break
case"SanSerif":s="ms-sans-serif"
break
case"Serif":s="ms-serif"
break
case"Monospaced":s="fixed-sys"}null!=s?t.addClass("appx-font-"+s):t.css("font-family",e.wFont)}if(e.wFontSize&&(t.css("font-size",e.wFontSize),t.addClass("appx-fontsize-adjusted")),e.wFontStyle)switch(e.wFontStyle){case"bold":t.css("font-weight","bold")
break
case"italic":t.css("font-style","italic")
break
case"bolditalic":t.css({"font-weight":"bold","font-style":"italic"})}if(e.wSetHorizAlign)switch(e.wSetHorizAlign){case"LEFT":t.css({"text-align":"left"})
break
case"RIGHT":t.css({"text-align":"right"})
break
case"CENTER":t.css({"text-align":"center"})}if(e.wSetVertAlign)switch(e.wSetVertAlign){case"BOTTOM":t.css({"vertical-align":"bottom"})
break
case"TOP":t.css({"vertical-align":"top"})
break
default:t.css({"vertical-align":"middle"})}e.wTooltip&&navigator.userAgent.indexOf("Mobile")===-1&&(t.data("title",e.wTooltip),t.addClass("appx-tooltip"),t.tooltip({fade:250,show:{delay:600},hide:{delay:200},open:function(e,t){setTimeout(function(){$(t.tooltip).hide("fade")},3e3)},items:".appx-tooltip",content:function(){return $(this).data("title")}}).on("focusin",function(){$(this).tooltip("close")}))}function appxTableCreateCellAttribute(e,t){var a={},s={},o="",i="",l=null,n=null,r=null,p=null
if(null==e)return a
if(e.wClasses)for(cls in e.wClasses.split(" "))cls.trim().length>0&&(s[cls.trim()]=1)
if(e.wColorBg&&(l=e.wColorBg,e.wColorBgNL&&(l+=(255*e.wColorBgNL).toString(16)),o+=' bgColor="'+l+'"'),e.wAltColorBg&&(r=e.wAltColorBg,o+=' altBgColor="'+r+'"'),null!=r&&1==t?(a["background-color"]=r,s["appx-bgcolor-adjusted"]=1):null!=l&&(a["background-color"]=l,s["appx-bgcolor-adjusted"]=1),e.wColorFg&&(n=e.wColorFg,e.wColorFgNL&&(n+=(255*e.wColorFgNL).toString(16)),o+=' fgColor="'+n+'"'),e.wAltColorFg&&(p=e.wAltColorFg,o+=' altFgColor="'+p+'"'),null!=p&&1==t?(a.color=p,s["appx-fgcolor-adjusted"]=1):null!=n&&(a.color=n,s["appx-fgcolor-adjusted"]=1),e.wFont){var w=null
switch(e.wFont){case"helvetica":w="default"
break
case"Courier":w="courier"
break
case"Helvetica":w="arial"
break
case"TimesRoman":w="times-roman"
break
case"Dialog":w="fixed-sys"
break
case"DialogInput":w="terminal"
break
case"ZapfDingbats":w="wingdings"
break
case"SanSerif":w="ms-sans-serif"
break
case"Serif":w="ms-serif"
break
case"Monospaced":w="fixed-sys"}null!=w?s["appx-font-"+w]=1:a["font-family"]=e.wFont,s["appx-font-adjusted"]=1}if(e.wFontSize&&(a["font-size"]=e.wFontSize+"px",s["appx-fontsize-adjusted"]=1),e.wFontStyle)switch(s["appx-fontstyle-adjusted"]=1,e.wFontStyle){case"bold":a["font-weight"]="bold"
break
case"italic":a["font-style"]="italic"
break
case"bolditalic":a["font-style"]="italic",a["font-weight"]="bold"}if(e.wSetHorizAlign){switch(e.wSetHorizAlign){case"LEFT":a["text-align"]="left"
break
case"RIGHT":a["text-align"]="right"
break
case"CENTER":a["text-align"]="center"}s["appx-textalign-adjusted"]=1}if(e.wSetVertAlign){switch(e.wSetVertAlign){case"BOTTOM":a["vertical-align"]="bottom"
break
case"TOP":a["vertical-align"]="top"
break
default:a["vertical-align"]="middle"}s["appx-valign-adjusted"]=1}if(e.wTooltip&&navigator.userAgent.indexOf("Mobile")===-1&&(o+=' title="'+e.wTooltip+'"',s["appx-tooltip"]=1),i=o,Object.keys(a).length>0){var d=""
i+=' style="'
for(d in a)i+=d+":"+a[d]+"; "
i+='"'}if(Object.keys(s).length>0){i+=' class="'
var c=""
for(c in s)i+=" "+c
i+='"'}return i}function appxAttachBlur(e,t){e.find(".appxdatevalue").length>0&&(e=e.find(".appxdatevalue")),e.blur(function(){"block"===t?appxIsLocked()&&$(this).focus():(appx_session.blur=!0,null!=appx_session.activeDatepicker||appxIsLocked()?logca("wx.blur: locked"):(appx_session.valueTimerStop(),appxPutTabOut(),logca("wx.blur"),setTimeout(function(e){logca("CommandLostFocus to: "+e),appxIsLocked()||appx_session.scan?logca("(locked)"):appxwidgetcallback(e)},100,t)))})}function appxwidgetshandlerprops(e,t){appxwidgetshandlerpropsex(e,t,!1)}function appxwidgetshandlerpropsex(wori,$tag,bTitlebar){var wx=wori,isWidget=!0
if(wori.hasOwnProperty("widget")){if(null==wori.widget)return void($tag&&appxIsDLUonTabOut(wori)&&appxAttachBlur($tag,OPT_DLU_ON_TABOUT))
wx=wori.widget,isWidget=!1}if(null!=wx&&null!=$tag){var wt=parseInt(wx.wWidgetType),bInput=$tag.is("input")||$tag.is("select")||$tag.is("textarea")
if(!bTitlebar){if($tag.html()&&wt!=WIDGET_TYPE_DATE_CHOOSER){var itemdata=$tag.html()
wt!=WIDGET_TYPE_CHECK_BOX&&wt!=WIDGET_TYPE_COLOR_CHOOSER&&$tag.html("")}switch(wt){case WIDGET_TYPE_LINE:wx.wSizeH||(wx.wSizeH=wx.size_row),wx.wSizeW||(wx.wSizeW=wx.size_col)
var bounds={height:wx.wSizeH,width:wx.wSizeW,x:wx.wPositionX,y:wx.wPositionY},offset={height:wx.wOffsetH,width:wx.wOffsetW,x:wx.wOffsetX,y:wx.wOffsetY},unitbase=appx_session.rowHeightPx
if(wx.wLineUnitBase)switch(wx.wLineUnitBase.toLowerCase()){case"w":unitbase=appx_session.colWidthPx
break
case"h":unitbase=appx_session.rowHeightPx
break
default:unitbase=parseInt(wx.wLineUnitBase)}var lineweightpct=-1,lineweight=-1
wx.wSetLineWeight&&(lineweightpct=wx.wSetLineWeight),lineweightpct<0&&(lineweight=.32*unitbase),lineweight<0&&(lineweight=lineweightpct/100*unitbase),lineweight<1&&(lineweight=1)
var lineweightwhole=~~lineweight,insets={top:lineweightwhole+1,left:lineweightwhole+1,bottom:lineweightwhole+1,right:lineweightwhole+1},ow=1==bounds.width&&offset.width<0?offset.width*-1/100:offset.width/100,oh=1==bounds.height&&offset.height<0?offset.height*-1/100:offset.height/100,dim={width:Math.abs(bounds.width)*appx_session.colWidthPx+ow*appx_session.colWidthPx+insets.left+insets.right-appx_session.colWidthPx,height:Math.abs(bounds.height)*appx_session.rowHeightPx+oh*appx_session.rowHeightPx+insets.top+insets.bottom-appx_session.rowHeightPx},beg={x:0,y:0},end={x:0,y:0}
beg.x=bounds.width>0?1==bounds.width&&offset.width<0?insets.left-offset.width:insets.left:dim.width-insets.right,beg.y=bounds.height>0?1==bounds.height&&offset.height<0?insets.top-offset.height:insets.top:dim.height-insets.bottom,end.x=bounds.width>0?1==bounds.width&&offset.width<0?insets.left:dim.width-insets.right:insets.left,end.y=bounds.height>0?1==bounds.height&&offset.height<0?insets.top:dim.height-insets.bottom:insets.top
var x=bounds.width>0?bounds.x:bounds.x+bounds.width+1,y=bounds.height>0?bounds.y:bounds.y+bounds.height+1,ox=bounds.width>0?1==bounds.width&&offset.width<0?offset.x+offset.width:offset.x:offset.x-offset.width,oy=bounds.height>0?1==bounds.height&&offset.height<0?offset.y+offset.height:offset.y:offset.y-offset.height,loc={x:x*appx_session.colWidthPx+(ox*appx_session.colWidthPx/100-insets.left),y:roundAwayFromZero(y*appx_session.rowHeightPx+(oy*appx_session.rowHeightPx/100-insets.top))}
$tag.css({background:"transparent"})
var $svg=$("<svg>").width("100%").height("100%"),$line=$("<line x1="+beg.x+" y1="+beg.y+" x2="+end.x+" y2="+end.y+" style='stroke: rgb(0,0,0); stroke-width:"+lineweightwhole+"'>")
switch($tag.width(dim.width),$tag.height(dim.height),$tag.css("top",loc.y+"px"),$tag.css("left",loc.x+"px"),wx.wColorFgDisabled&&$line.css({stroke:wx.wColorFgDisabled}),wx.wEndcapType){case 2:$line.css({"stroke-linecap":"square"})
break
case 1:$line.css({"stroke-linecap":"round"})
break
case 0:$line.css({"stroke-linecap":"none"})
break
default:$line.css({"stroke-linecap":"round"})}if(wx.wStrokePattern){var adjPattern=wx.wStrokePattern.split(","),p2=[]
$.each(adjPattern,function(e,t){p2.push(parseInt(t)*lineweightwhole)}),$line.css({"stroke-dasharray":p2.toString()})}wx.wStrokePatternOffset&&$line.css({"stroke-dashoffset":wx.wStrokePatternOffset*lineweightwhole}),$svg.html($line[0].outerHTML),$tag.append($svg[0].outerHTML),$tag.addClass("line")
break
case WIDGET_TYPE_PICTURE:$tag.addClass("picture"),wx.wIconDisabled?$tag.addClass(AppxResource.load(wx.wIconDisabled)+"_pic"):wx.wIconWallpaper&&$tag.addClass(AppxResource.load(wx.wIconWallpaper)+"_pic")
var clsPic=appxGetClassIcon(wx,bTitlebar)
$tag.addClass(clsPic)
var tagCSS=""
if(wx.wSetImageScale){var scale=wx.wSetImageScale+"%"
tagCSS=100!=wx.wSetImageScale?scale:$tag.hasClass("appx-icon-expand-fill")?"100% 100%":"contain"}$tag.css({"background-size":tagCSS,"background-position":wx.wSetHorizAlign+" "+wx.wSetVertAlign})
break
case WIDGET_TYPE_SLIDER:$tag.css({height:$tag.height()+50,width:$tag.width()+15})
break
case WIDGET_TYPE_PROGRESS_BAR:break
case WIDGET_TYPE_LISTBOX:var opt=wx.wCommand
$tag.change(function(){opt&&appxwidgetcallback(opt)})
break
case WIDGET_TYPE_CHECK_BOX:break
case WIDGET_TYPE_PASSWORD:$tag.prop("type","password")
break
case WIDGET_TYPE_FILE_CHOOSER:var fulc=wx.fileUseLocalConnector
$tag.on("click",function(e){if(fulc){if(localos_session&&1==localos_session.ws.readyState){var t="awaiting_filepath"
$(this).addClass(t)
var a={cmd:"file-dialog-nw",args:[],handler:"",data:{dbg:!1,wDnD:wx.wDragAndDrop,wgtid:t,wPosX:wx.wPositionX+1,wPosY:wx.wPositionY+1},authToken:localStorage.authToken}
return localos_session.ws.send(JSON.stringify(a)),!1}}else $("#fileChooser").click()})
break
case WIDGET_TYPE_TABLE:wx.tableHashKey=AppxTable.updateTableFromWidget(wx),$tag.data("tableHashKey",wx.tableHashKey)}}if(wx.wBorder){switch($tag.addClass("appx-border"),wx.wBorder){case BORDER_NONE:$tag.addClass("appx-border-none")
break
case BORDER_BEVEL_RAISED:$tag.addClass("appx-border-bevel-raised")
break
case BORDER_SOFT_BEVEL_RAISED:$tag.addClass("appx-border-soft-bevel-raised")
break
case BORDER_BEVEL_SUNKEN:$tag.addClass("appx-border-bevel-sunken")
break
case BORDER_SOFT_BEVEL_SUNKEN:$tag.addClass("appx-border-soft-bevel-sunken")
break
case BORDER_ETCHED_SUNKEN:$tag.addClass("appx-border-etched-sunken")
break
case BORDER_ETCHED_RAISED:$tag.addClass("appx-border-etched-raised")
break
case BORDER_IMAGE_EDITOR:$tag.addClass("appx-border-image-editor")
break
case BORDER_SIMPLE_LINE:$tag.addClass("appx-border-simple-line")
break
case BORDER_SIMPLE_LINE_WIDER:$tag.addClass("appx-border-simple-line-wider")}wx.wColorFgDisabled&&$tag.attr("style",$tag.attr("style")+";border-color:"+wx.wColorFgDisabled+" !important")}else $tag.is("fieldset")&&$tag.addClass("appx-border-etched-sunken"),$tag.is(".appx-html-viewer")&&$tag.addClass("appx-border appx-border-bevel-sunken")
if(wx.wColorBgWallpaper&&!bTitlebar?(wt!==WIDGET_TYPE_ERROR&&($tag.css("background-color",wx.wColorBgWallpaper),wx.wColorBgWallpaperNL&&$tag.css("opacity",wx.wColorBgWallpaperNL)),null!==wx.wContentAreaFilled&&0==wx.wContentAreaFilled&&$tag.css("background-color","transparent")):((null===wx.wContentAreaFilled&&wt===WIDGET_TYPE_LABEL||null!=wx.wContentAreaFilled&&!wx.wContentAreaFilled&&!bTitlebar&&wt!==WIDGET_TYPE_ERROR)&&(wx.wColorBg="transparent"),$tag.hasClass("appx-title")?(wx.wColorBg&&$tag.css("background-color",wx.wColorBg),wx.wColorBgNL&&$tag.css("opacity",wx.wColorBgNL)):$tag.attr("id")&&$tag.attr("id").indexOf("box")>-1?(wx.wColorBgWallpaper&&$tag.css("background-color",wx.wColorBgWallpaper),wx.wColorBgWallpaperNL&&$tag.css("opacity",wx.wColorBgWallpaperNL),null!==wx.wContentAreaFilled&&0==wx.wContentAreaFilled&&$tag.css("background-color","transparent")):(wx.wColorBg&&$tag.css("background-color",wx.wColorBg),wx.wColorBgNL&&$tag.css("opacity",wx.wColorBgNL))),wx.wColorFg&&(!bInput&&null!=wx.wEnabled&&0==wx.wEnabled&&wx.wColorBgDisabled&&wt===WIDGET_TYPE_ERROR||$tag.hasClass("error")||($tag.css("color",wx.wColorFg),wx.wColorFgNL&&$tag.css("opacity",wx.wColorFgNL))),!bInput&&null!=wx.wEnabled&&0==wx.wEnabled&&wx.wColorBgDisabled&&($tag.css("background-color",wx.wColorBgDisabled),$tag.css("-webkit-filter","grayscale(0%)")),appx_session.getProp("showOptionNumbers")&&wx.wCommand&&wx.wCommand<256&&$("<span>").addClass("appx-option").html(wx.wCommand).appendTo($tag),wx.wCommandGotFocus&&($tag.find(".appxdatevalue").length>0?$tag.find(".appxdatevalue").focus(function(){appx_session.valueTimerStop(),appxIsLocked()?logca("wx.focus: locked"):(logca("wx.focus "+wx.wCommandGotFocus),appxwidgetcallback(wx.wCommandGotFocus))}):$tag.focus(function(){appx_session.lastOption&&"333"!==appx_session.lastOption&&(this.selectionStart=this.selectionEnd=this.value.length),appx_session.valueTimerStop(),appxIsLocked()||appx_session.scan?logca("wx.focus: locked"):(logca("wx.focus "+wx.wCommandGotFocus),appxwidgetcallback(wx.wCommandGotFocus))})),wx.wCommand>=20101&&wx.wCommand<=20106&&appxWidgetCheckSelected(wx),wx.wLocalList&&$tag.is("select")){var delim=wx.wLocalList.charAt(0),st2=wx.wLocalList.split(delim),arrayLength=st2.length
$tag.hasClass("appx-nullok")&&$tag.append("<option></option>")
for(var i=1;i<arrayLength;i++){var frag=$("<option></option>").val(st2[i]).html(st2[i])
$tag.append(frag)}$tag.val($tag.attr("data")),$tag.addClass("appx-local-list")}if((wx.wCommandLostFocus||!isWidget&&appxIsDLUonTabOut(wori))&&(wx.wCommandLostFocus&&!isWidget&&appxIsDLUonTabOut(wori)?appxAttachBlur($tag,OPT_DLU_AND_TABOUT):wx.wCommandLostFocus?appxAttachBlur($tag,OPT_TAB_OUT):!isWidget&&appxIsDLUonTabOut(wori)?appxAttachBlur($tag,OPT_DLU_ON_TABOUT):appxAttachBlur($tag,"block")),wx.wDefaultButton&&wt==WIDGET_TYPE_BUTTON&&($tag.addClass("default"),wx.wBorder!=BORDER_NONE&&$tag.addClass("defaultBorder")),wx.wDragAndDrop&&$tag.on("dragenter",function(e){if(e.dataTransfer=e.originalEvent.dataTransfer,wx.fileUseLocalConnector===!0){if(localos_session&&1==localos_session.ws.readyState){eventCatcher(e)
var t={cmd:"dnd",args:[],handler:"",data:{dbg:!1,wDnD:wx.wDragAndDrop,wPrnt:WIDGET_PRNT_TYPE_WIDGET,wPosX:wx.wPositionX+1,wPosY:wx.wPositionY+1},authToken:localStorage.authToken}
return localos_session.ws.send(JSON.stringify(t)),!1}}else{var a,s=$tag.position().top,o=$tag.position().left,i=$tag.height(),l=$tag.offset().left,n=e.pageX,r=($tag.width()-(n-l),$tag.parent()),p=$tag
a="dir"===wx.wDragAndDrop?$("<div class='DnD' id='DnD' webkitdirectory>"):$("<div class='DnD' id='DnD'>"),a.css({top:s-i/2+"px",left:o+"px",height:2*i+"px",width:$tag.width()+"px",border:"2px dashed grey",position:"absolute",display:"flex","text-indent":$tag.width()/2-30+"px",color:"grey","align-items":"center","z-index":99999}).text("Drop Here").appendTo(r),a.on("dragleave",function(){$(this).remove()}),a.on("dragover",function(e){e.stopPropagation(),e.preventDefault(),e.dataTransfer=e.originalEvent.dataTransfer,e.dataTransfer.dropEffect="copy"}),a.on("drop",function(e){e.dataTransfer=e.originalEvent.dataTransfer,e.stopPropagation(),e.preventDefault(),appx_session.dropEvent=e
var t=e.dataTransfer.files.length
t>=1?(t>1?p.val("Directory with "+t+" files."):p.val(e.dataTransfer.files[0].name.replace(/\ /g,"_")),$(this).data("#Files",t),p.addClass("dirty"),appxReadBlob($(this).attr("id"),function(){appxwidgetcallback(OPT_DROP)}),p.hasClass("appxfilewrapper")||p.addClass("appxfilewrapper"),p.hasClass("DnD")?p.addClass("Dropped"):p.addClass("DnD Dropped")):fileUploadError("The file you chose"),$(this).hide()})}}),null!=wx.wEnabled&&0==wx.wEnabled&&($tag.prop("disabled",!0),null==wx.wColorBgDisabled&&0!=wx.wContentAreaFilled&&$tag.addClass("no-disabled-data")),wx.wFont||wx.wWidgetType!=WIDGET_TYPE_LABEL||(wx.wFont="helvetica"),wx.wFont){var ff=null
switch(wx.wFont){case"helvetica":ff=bInput?"default-input":"default"
break
case"Courier":ff="courier"
break
case"Helvetica":ff="arial"
break
case"TimesRoman":ff="times-roman"
break
case"Dialog":ff="fixed-sys"
break
case"DialogInput":ff="terminal"
break
case"ZapfDingbats":ff="wingdings"
break
case"SanSerif":ff="ms-sans-serif"
break
case"Serif":ff="ms-serif"
break
case"Monospaced":ff="fixed-sys"}null!=ff?$tag.addClass("appx-font-"+ff):$tag.css("font-family",wx.wFont)}if(wt==WIDGET_TYPE_TABLE&&(wx.wFontSize?$tag.css("line-height",1.67*wx.wFontSize+"px"):$tag.css("line-height",1.5*appx_session.basefontsize+"px")),wx.wFontSize&&!wx.isBox?$tag.css("font-size",wx.wFontSize):wt==WIDGET_TYPE_BUTTON||wt==WIDGET_TYPE_TABLE||bTitlebar?$tag.css("font-size",1.5*appx_session.colWidthPx):$tag.css("font-size",1.67*appx_session.colWidthPx),wx.wFontStyle)switch(wx.wFontStyle){case"bold":$tag.css("font-weight","bold")
break
case"italic":$tag.css("font-style","italic")
break
case"bolditalic":$tag.css({"font-weight":"bold","font-style":"italic"})}if(wx.wWidgetType==WIDGET_TYPE_LABEL)if(wx.wSizeH<2)if($tag.css("white-space","pre"),wx.wFontSizePercent){var tagHeight=parseInt($tag.css("height").substring(0,$tag.css("height").indexOf("px")))
$tag.css("line-height",.01*wx.wFontSizePercent*tagHeight+"px")}else $tag.css("line-height",$tag.css("height"))
else"IE"==checkBrowser()?$tag.css("line-height","normal"):$tag.css("line-height","initial")
"autoedit"==wx.wHtmlViewerType&&$tag.addClass("ckeditor")
var $img=null,clsIconProp=null
if((wx.wIconEnabled||wx.wIconDisabled||wx.IconRollover)&&!wx.isBox&&wt!=WIDGET_TYPE_PICTURE&&($img=$("<img>"),null!=wx.wEnabled&&1!=wx.wEnabled&&null!=wx.wIconDisabled||!wx.wIconEnabled?0==wx.wEnabled&&wx.wIconDisabled?$img.addClass(AppxResource.load(wx.wIconDisabled)+"_img"):wx.wIconWallpaper&&$img.addClass(AppxResource.load(wx.wIconWallpaper)+"_img"):(clsIconProp=AppxResource.load(wx.wIconEnabled),$img.addClass(clsIconProp+"_img"))),wx.wIconWallpaper&&wt!=WIDGET_TYPE_PICTURE&&!bTitlebar&&!$tag.is("button"))switch($tag.addClass(AppxResource.load(wx.wIconWallpaper)),wx.wTilingMode?wx.wTilingMode!=MODE_TILE&&$tag.css("background-repeat","no-repeat no-repeat"):wx.wTilingMode=MODE_TILE,wx.wTilingMode){case MODE_TILE:$tag.css("background-repeat","repeat repeat")
break
case MODE_EXPAND:$tag.css("background-size","100% 100%")
break
case MODE_CENTER:$tag.css("background-position","center center")
break
case MODE_N:$tag.css("background-position","center top")
break
case MODE_E:$tag.css("background-position","right center")
break
case MODE_S:$tag.css("background-position","center bottom")
break
case MODE_W:$tag.css("background-position","left center")
break
case MODE_NE:$tag.css("background-position","right top")
break
case MODE_NW:$tag.css("background-position","left top")
break
case MODE_SE:$tag.css("background-position","right bottom")
break
case MODE_SW:$tag.css("background-position","left bottom")}wx.wJscript&&$tag.bind(wx.wJevent,function $_bind(){eval(wx.wJscript)})
var cel=appxGetCellSize()
if(wx.wMarginB&&$tag.css("padding-bottom",wx.wMarginB*cel.h/100),wx.wMarginL&&$tag.css("padding-left",wx.wMarginL*cel.w/100),wx.wMarginR&&$tag.css("padding-right",wx.wMarginR*cel.w/100),wx.wMarginT||wt!=WIDGET_TYPE_TEXT_AREA||(wx.wMarginT=10),wx.wMarginT&&$tag.css("padding-top",wx.wMarginT*cel.h/100),wx.wSetDropShadow){var factor=.01*((appx_session.rowHeightPx+appx_session.colWidthPx)/2),distance=wx.wSetDropShadowDistance*factor,size=Math.round(wx.wSetDropShadowSize*factor),angle=wx.wSetDropShadowAngle*(Math.PI/180),opacity=wx.wSetDropShadowOpacity,color=appxColorXlate(wx.wSetDropShadowColor,opacity),horx=Math.round(distance*Math.cos(angle)),very=Math.round(distance*Math.sin(angle)),blur=size,spread=size/100
if(null!=wx.wContentAreaFilled&&!wx.wContentAreaFilled||$tag.hasClass("label")||$tag.hasClass("line")){var shade=horx+"px "+very+"px "+blur+"px "+color
$tag.hasClass("line")?$tag.children("svg").css({"-webkit-filter":"drop-shadow("+shade+")",filter:"drop-shadow("+shade+")"}):$tag.css("text-shadow",shade)}else{var shade=horx+"px "+very+"px "+blur+"px "+spread+"px "+color
$tag.css("box-shadow",shade)}}if(wx.wSetHorizTextPos&&bInput)switch(wx.wSetHorizTextPos){case"CENTER":$tag.css("text-align","center")
break
case"LEFT":$tag.css("text-align","left")
break
case"RIGHT":$tag.css("text-align","right")}if(wx.wTooltip&&navigator.userAgent.indexOf("Mobile")===-1&&($tag.data("title",wx.wTooltip),$tag.addClass("appx-tooltip"),$tag.tooltip({fade:250,show:{delay:600},hide:{delay:200},open:function(e,t){setTimeout(function(){$(t.tooltip).hide("fade")},3e3)},items:".appx-tooltip",content:function(){return $(this).data("title")}}).on("focusin",function(){$(this).tooltip("close")})),null!=wx.wVisible&&0==wx.wVisible&&$tag.css("display","none"),bInput||wt==WIDGET_TYPE_ROWTEXT)wx.wLabel&&wt!=WIDGET_TYPE_FILE_CHOOSER?bInput?$tag.val(wx.wLabel):$tag.html(wx.wLabel):itemdata&&$tag.html(itemdata)
else if(wt===WIDGET_TYPE_BOX&&null!==wx.wLabel){var classes,align="left"
null===wx.wSetVertAlign||"TOP"===wx.wSetVertAlign?null===wx.wSetHorizAlign||"LEFT"===wx.wSetHorizAlign?classes="legend-top-left":"CENTER"===wx.wSetHorizAlign?(align="center",classes="legend-top-center"):"RIGHT"===wx.wSetHorizAlign&&(align="right",classes="legend-top-right"):(null===wx.wSetHorizAlign||"LEFT"===wx.wSetHorizAlign?(align="right",classes="legend-bottom-left"):"CENTER"===wx.wSetHorizAlign?(align="center",classes="legend-bottom-center"):"RIGHT"===wx.wSetHorizAlign&&(align="left",classes="legend-bottom-right"),$tag.addClass("fieldset-bottom")),$tag.html("<legend align='"+align+"' class='"+classes+"'>"+wx.wLabel+"</legend>")}else if(wt===WIDGET_TYPE_COLOR_CHOOSER)$tag.find("input").addClass("appx-data")
else if(wt!=WIDGET_TYPE_CHECK_BOX){var $box=$("<div>").addClass("appx--box")
if($box.css({width:"100%"}),!$tag.hasClass("appx-menu-item"))if(wori.isBox&&$tag.hasClass("appxbox"))$box.appendTo($tag)
else{var clsText=appxGetClassText(wx)
$box.addClass(clsText).appendTo($tag)}var $div=$("<div>").addClass("appx-data")
if(null!=wx.wLabel&&"<html>"==wx.wLabel.substr(0,6).toLowerCase()&&(wx.wLabel=wx.wLabel.substr(6)),wx.wShortcut&&$tag.is("button")){var sc=wx.wShortcut.toUpperCase()
if("D"!=sc&&"C"!=sc&&($tag.addClass("appx-shortcut-"+sc.charCodeAt(0)),wx.wLabel&&wx.wLabel.indexOf("<")==-1)){$div.attr("accesskey",sc)
var lbl=wx.wLabel,pos=lbl.indexOf(sc)
pos==-1&&(pos=lbl.indexOf(sc.toLowerCase())),pos!=-1&&(wx.wLabel=lbl.substr(0,pos)+'<span class="accesskeyunderline">'+lbl.substr(pos,1)+"</span>"+lbl.substr(pos+1))}}if(wt===WIDGET_TYPE_PROGRESS_BAR&&null!==wx.wColorBg&&$div.css({"background-color":wx.wColorBg}),wx.wLabel&&!wx.isBox&&wt!=WIDGET_TYPE_LINE?(wt===WIDGET_TYPE_LABEL||""===itemdata||void 0===itemdata?$div.html(wx.wLabel):$div.html(itemdata),bTitlebar&&$div.width("100%")):itemdata&&$div.html(itemdata),null==$img)!wx.wLabel&&!itemdata||$tag.hasClass("appxdatefield")||$box.append($div)
else{if($box.addClass(ICON),wx.wSetImageScale&&wx.wTilingMode!=MODE_EXPAND&&wx.wTilingMode!=MODE_TILE){var height
height=wx.wFontSize?wx.wFontSize*(wx.wSetImageScale/100)*.66:basefontsize*(wx.wSetImageScale/100)*.66,$img.height(height)}var clsIcon=appxGetClassIcon(wx,bTitlebar)
if($box.addClass(clsIcon),"appx-icon-expand-prop"!=clsIcon)clsIcon==ICON_ABOVE_TEXT?($box.append($img),$box.append($div)):clsIcon.indexOf("leading")!=-1?($box.addClass(ICON_LEADING),$box.append($img),$box.append($div)):(clsIcon.indexOf("trailing")!=-1?$box.addClass(ICON_TRAILING):clsIcon==ICON_BEHIND_TEXT&&$div.css("text-align","center"),$box.append($div),$box.append($img))
else{$box.append($div),$box.addClass(clsIconProp+"_ico")
var bgPos="center"
null!=wx.wSetHorizAlign&&null!=wx.wSetVertAlign?bgPos=wx.wSetHorizAlign+" "+wx.wSetVertAlign:null!=wx.wSetHorizAlign?bgPos=wx.wSetHorizAlign+" center":null!=wx.wSetVertAlign&&(bgPos="center "+wx.wSetVertAlign),$box.css({"background-size":"contain","background-position":bgPos,"background-repeat":"no-repeat"})}}}if((wx.wColorBgRollover||wx.wColorBgRolloverNL||wx.wColorFgRollover||wx.wColorFgRolloverNL||wx.wIconRollover)&&$tag.prop("disabled")===!1){if(wx.wIconRollover){$tag.addClass(AppxResource.load(wx.wIconRollover)+"_imgRO")
var iconRollover=function(){var e=$img.attr("src"),t=$tag.attr("srcRO")
void 0!=e&&void 0!=t&&($tag.attr("srcRO",e),$img.attr("src",t))}}$tag.mouseenter(function(){wx.wColorBgRollover&&$tag.css("background-color",wx.wColorBgRollover),wx.wColorBgRolloverNL&&$tag.css("opacity",wx.wColorBgRolloverNL),wx.wColorFgRollover&&$div.css("color",wx.wColorFgRollover),wx.wColorFgRolloverNL&&$div.css("opacity",wx.wColorFgRolloverNL),wx.wIconRollover&&iconRollover()}).mouseleave(function(){wx.wColorBgRollover&&$tag.css("background-color",wx.wColorBg?wx.wColorBg:""),wx.wColorBgRolloverNL&&$tag.css("opacity",wx.wColorBgNL?wx.wColorBgNL:1),wx.wColorFgRollover&&$div.css("color",wx.wColorFg?wx.wColorFg:""),wx.wColorFgRolloverNL&&$div.css("opacity",wx.wColorFgNL?wx.wColorFgNL:1),wx.wIconRollover&&iconRollover()})}if(bTitlebar){var $boxTitle=$("<span>").addClass("appx-title-buttons").appendTo($tag)
"Firefox"!==checkBrowser()&&"IE"!==checkBrowser()&&$boxTitle.addClass("right-padding-only")
var titleBarButton=function(e){var t=$("<button type='button'>").css({"font-size":~~(1.4*appx_session.colWidthPx)+"px",height:appx_session.rowHeightPx-4+"px",width:appx_session.rowHeightPx-4+"px"})
switch(e){case OPT_END:t.addClass("appx-title-button-close").html("X")
break
case OPT_ENTER:t.addClass("appx-title-button-ok").html("&#10004;")
break
case OPT_WHATS_THIS:t.addClass("appx-title-button-help").html("?")}t.appendTo($boxTitle)}
null!=wx.wShowHelp&&1!=wx.wShowHelp||titleBarButton(OPT_WHATS_THIS),null!=wx.wShowOk&&1!=wx.wShowOk||titleBarButton(OPT_ENTER),null!=wx.wShowClose&&1!=wx.wShowClose||titleBarButton(OPT_END)}if(wx.wClasses&&$tag.addClass(wx.wClasses),wx.wExtraAttrs)for(var i=0;i<wx.wExtraAttrs.length;i++)2==wx.wExtraAttrs[i].length&&$tag.attr(wx.wExtraAttrs[i][0],wx.wExtraAttrs[i][1])
if($tag.hasClass("ckeditor")&&null!=wx.wEditorConfig){if(!appx_session.editorConfigs.hasOwnProperty(wx.wEditorConfig)){var temp=wx.wEditorConfig.split("."),cacheid=cleanClassName(appx_session.server+"_"+appx_session.port+"_"+temp[0].substring(1)+"_"+temp[1]+"_"+temp[2])
appx_session.editorConfigs[cacheid]=null,AppxResource.load(wx.wEditorConfig)}$tag.data("editorConfig",cacheid)}$tag.is(":input")||$tag.addClass("context-selector"),$tag.hasClass("appx-menu-item")&&$tag.text(wx.wLabel)}}function GridCacheProps(){var e=this
e.lastSortName=null,e.lastSortOrder=null,e.scrollLeft=null,e.selrows=[]}function appxWidgetCheckSelected(e){var t=null,a=null
switch(e.wCommand){case 20101:break
case 20102:t="showOptionNumbers",a=appx_session.getProp(t)
break
case 20103:t="autoTabOut",a=appx_session.getProp(t)
break
case 20104:t="autoSelect",a=appx_session.getProp(t)
break
case 20105:break
case 20106:}e.wSelected=a}function Widget(e,t,a,s,o){var i=this
i.boxid=e,i.html=t,i.forceAntiAlias=-1,i.forceMultiLine=-1,i.forceMovable=-1,i.wClientId=null,i.wWidgetId=null,i.wLayer=null,i.wLabel=null,i.wShortLabel=null,i.wTooltip=null,i.wGroupName=null,i.wShortcut=null,i.wMovableCommand=null,i.wCommand=null,i.wCommand2=null,i.wCommandGotFocus=null,i.wCommandLostFocus=null,i.wCommandValueAdjusted=null,i.wLocalList=null,i.wEnabled=null,i.wUsageMenu=!1,i.wUsageToolbar=!1,i.wUsagePopup=!1,i.wSepBefore=null,i.wSepAfter=null,i.wRolloverEnabled=null,i.wBorderPainted=null,i.wContentAreaFilled=null,i.wSelected=null,i.wFocusPainted=null,i.wVisible=null,i.wRequiresSelection=null,i.wInvert=null,i.wPaintTicks=null,i.wPaintTickLabels=null,i.wSnapToTicks=null,i.wShowHelp=null,i.wShowClose=null,i.wShowOk=null,i.wShowMax=null,i.wShowMin=null,i.wMovable=null,i.wSetMoveCursor=!1,i.wResizable=null,i.wDockable=null,i.wDefaultButton=null,i.wTabable=null,i.wColorFg=null,i.wColorFgNL=null,i.wColorBg=null,i.wColorBgNL=null,i.wColorFgDisabled=null,i.wColorFgDisabledNL=null,i.wColorBgDisabled=null,i.wColorBgDisabledNL=null,i.wColorFgRollover=null,i.wColorFgRolloverNL=null,i.wColorBgRollover=null,i.wColorBgRolloverNL=null,i.wColorBgWallpaper=null,i.wColorBgWallpaperNL=null,i.wFileFilter=null,i.wMinValue=null,i.wMaxValue=null,i.wTickMajor=null,i.wTickMinor=null,i.wTilingMode=null,i.wBorder=null,i.wWidgetType=null,i.wWidgetOriginalType=null,i.wMarginT=null,i.wMarginB=null,i.wMarginL=null,i.wMarginR=null,i.wPositionX=null,i.wPositionY=null,i.wSizeW=null,i.wSizeH=null,i.wOffsetX=null,i.wOffsetY=null,i.wOffsetW=null,i.wOffsetH=null,i.wTabGroup=null,i.wFileChooserMode=null,i.wEndcapType=null,i.wBoxNumber=null,i.wTabSubGroupId=null,i.wIconEnabled=null,i.wIconDisabled=null,i.wIconPressed=null,i.wIconSelected=null,i.wIconRollover=null,i.wIconRolloverSelected=null,i.wIconWallpaper=null,i.wSetHorizTextPos=null,i.wSetVertTextPos=null,i.wSetHorizAlign=null,i.wSetVertAlign=null,i.wOrientation=null,i.wFont=null,i.wFontSize=null,i.wFontSizePercent=null,i.wFontStyle=null,i.wSetFormSize=null,i.wSetProcessType=null,i.wSetFrameClass=null,i.wSetImageScale=null,i.wSetLineWeight=null,i.wSetStrokeWeight=null,i.wSetBorderArc=null,i.wSetAntiAlias=null,i.wSetDropShadow=null,i.wSetDropShadowSize=null,i.wSetDropShadowOpacity=null,i.wSetDropShadowColor=null,i.wSetDropShadowDistance=null,i.wSetDropShadowAngle=null,i.wSetScroller=null,i.wSignature=null,i.wForceWidget=null,i.wStrokePattern=null,i.wStrokePatternOffset=null,i.wLineUnitBase=null,i.wHtmlViewerType=null,i.wDragAndDrop=null,i.wResFont=null,i.wResBundle=null,i.wEditorConfig=null,i.wPcbId=null,i.wFrameImageKey=null,i.wHashSig=null,i.wMenuNo=null,i.wMenuUse=null,i.delimiter="\t",i.delimiterStr=""+i.delimiter,i.widgetLen=0,i.widgetData=a,i.widgetExtraData=s,i.widgetExtraLen=0,i.wJscript=null,i.wJevent=null,i.bytesInCount=0,i.tableHashKey=null,i.tableShowRowNumbers=!0,i.tableShowFooterBar=!0,i.tableShowHeading=!0,i.tableCaseSort=!1,i.tableShowCsvOption=!0,i.tableShowPageOption=!0,i.tableShowColChooser=!0,i.tableShowLayoutSave=!0,i.tableShowTableRefresh=!0,i.tableShowTableSearch=!0,i.tableShowTableReset=!0,i.tableColumnSortable=null,i.tableColumnSortType=null,i.tableColumnResizable=null,i.tableColumnSearchable=!0,i.tableColumnDateFormat=null,i.tableMovableColumn=!0,i.wAltColorFg=null,i.wAltColorFg=null,void 0!==$("meta[name=appx-upload-without-local]").attr("content")&&"true"===$("meta[name=appx-upload-without-local]").attr("content")?i.fileUseLocalConnector=!1:i.fileUseLocalConnector=!0,i.specialHorizontalLocation=null,i.specialVerticalLocation=null,o&&(i.size_row=o.size_row,i.size_col=o.size_col),i.parseData()}function scrollSwitch(e,t,a,s){$("#"+e).jqGrid("GridUnload"),$("#"+t).remove(),$("#"+e).remove()
var o,i=($("#"+s).data("tableID"),$("#"+s).data("tableHashKey"))
void 0!==a.virtualScroll?a.virtualScroll=!a.virtualScroll:(o=void 0===appx_session.gridpropscache[i]||void 0===appx_session.gridpropscache[i].virtualScroll?appx_session.getProp("gridVirtualScroll"):appx_session.gridpropscache[i].virtualScroll,a.virtualScroll=!o),createGridMongo(a,s)}function gridSetDefaults(e,t,a,s){$("#"+e).jqGrid("GridUnload"),$("#"+t).remove(),$("#"+e).remove()
var o=$("#"+s).data("tableID")
a.colModel=appx_session.tableDefaults[o].colModel,a.scrollPosition=null,a.virtualScroll=appx_session.getProp("gridVirtualScroll"),delete a.lastSortColumns,delete a.lastSortName,delete a.lastSortOrder,delete a.selectedKeys,delete a.colMapNames,createGridMongo(a,s)}function createGridMongo(e,t){AppxTable.createGridMongo(t)}function createWidgetTagObject(){appx_session.createWidgetTag[WIDGET_TYPE_BUTTON]=function(e,t,a){var s=e.wCommand
return null===s&&null!==e.wCommandValueAdjusted&&(s=e.wCommandValueAdjusted),t=$("<button type='button'>").css({margin:"0",padding:"0"}),t.addClass("button").data("row",e.wPositionY).data("col",e.wPositionX),arguments.length>2&&null==e.wLabel&&null!=a.data&&(e.wLabel=a.data),null!=s&&(s===OPT_WHATS_THIS?t.addClass("appx-title-button-help"):(t.attr("id",addClientId("widget_sac_"+s,e.wClientId)),t.click(function(){var e=parseInt(getClientId(this.id).substring(11))
if(e>=250&&e<=255||$(this).hasClass("setMoveCursor")){var t=$(this).data("col"),a=$(this).data("row")
t&&a&&appxPutCursor(t,a)}appxwidgetcallback(getClientId(this.id).substring(11))}))),e.wSetMoveCursor&&t.addClass("setMoveCursor"),e.wBorder||(e.wBorder=BORDER_BEVEL_RAISED),t},appx_session.createWidgetTag[WIDGET_TYPE_COLOR_CHOOSER]=function(e,t,a){t=$("<div>"),t.addClass("appxcolorpickerwrapper")
var s=$("<input type='text' class='appxitem'>")
$(s).addClass("appxcolorpicker")
var o=$("<img src='"+appxClientRoot+"/images/colorpicker.jpg' />").css({position:"absolute",right:"0px",top:"2px","z-index":1e5})
return s.val(a.data),t.append(s),t.append(o),t},appx_session.createWidgetTag[WIDGET_TYPE_LABEL]=function(e,t){return t=$("<div>"),t.addClass("label"),t.attr("id",addClientId("widget_sac_"+e.wPositionX+"_"+e.wPositionY,e.wClientId)),t},appx_session.createWidgetTag[WIDGET_TYPE_CHECK_BOX]=function(e,t,a){if("y"==a.data.charAt(0)||"Y"==a.data.charAt(0)||"1"==a.data.charAt(0)?a.data="1":"n"!=a.data.charAt(0)&&"N"!=a.data.charAt(0)&&"0"!=a.data.charAt(0)||(a.data="0"),appxIsModifiable(a)){var s="<input type='checkbox' "
"0"==a.data?s+="value='0' ":"1"==a.data?s+="value='1' checked='checked' ":i=!0,s+="class='item_with_widget appxitem notranslate appxfield' style='position: absolute; top: 3px; height: 10px; font-size: 13.36px; overflow: hidden; white-space: pre;' >",o=$(s),1==i&&o.prop("indeterminate",!0),t=$("<label class='checkbox-label' ></label>"),t.append(o),t.append("<span class='checkbox-custom rectangular' ></span> ")}else{var o,i=!1,l="<input disabled='true' type='checkbox' "
"0"==a.data?l+="value='0' ":"1"==a.data?l+="value='1' checked='checked' ":i=!0,l+="class='item_with_widget appxitem notranslate appxfield disabled' style='position: absolute; top: 3px; height: 10px; font-size: 13.36px; overflow: hidden; white-space: pre;' >"
var o=$(l)
1==i&&o.prop("indeterminate",!0),t=$("<label class='checkbox-label disabled' ></label>"),t.append(o),t.append("<span class='checkbox-custom rectangular' ></span> ")}return"1"==a.data?(t.prop("checked",!0),t.data("checked",2),o.prop("checked",!0),o.data("checked",2)):"0"==a.data?(t.prop("checked",!1),t.data("checked",0),o.prop("checked",!1),o.data("checked",0)):(t.prop("indeterminate",!0),t.data("checked",1),o.prop("indeterminate",!0),o.data("checked",1)),t.val(a.data),t},appx_session.createWidgetTag[WIDGET_TYPE_LISTBOX]=function(e,t,a){return $("<select data='"+a.data+"'>").val(a.data).addClass("appx-listbox")},appx_session.createWidgetTag[WIDGET_TYPE_PICTURE]=function(e,t){return $("<div>")},appx_session.createWidgetTag[WIDGET_TYPE_BOX]=function(e,t){return $("<fieldset>").css({margin:"0","text-align":"left"})},appx_session.createWidgetTag[WIDGET_TYPE_LINE]=function(e,t){return $("<div>")},appx_session.createWidgetTag[WIDGET_TYPE_PROGRESS_BAR]=function(e,t,a){return t=$("<div>").progressbar({value:parseInt(a.data)}),t.find(".ui-progressbar-value").height(a.size_rows*appx_session.rowHeightPx),t.find(".ui-progressbar-value").css({background:"none","background-color":e.wColorFg}),t},appx_session.createWidgetTag[WIDGET_TYPE_PASSWORD]=function(e,t,a){return $("<input type='password'>").val(a.data)},appx_session.createWidgetTag[WIDGET_TYPE_HTML_EDITOR]=function(e,t){return t=$("<div>").css({padding:"0"}),t.html(item.data),t.addClass("ckeditor"),t},appx_session.createWidgetTag[WIDGET_TYPE_HTML_VIEWER]=function(e,t,a){switch(t=$("<div>").css("padding","0"),t.html(a.data),t.addClass("appx-html-viewer"),e.wHtmlViewerType){case"flash":t=$("<object data='"+a.data+"'></object>")
break
case"media":t=$("<embed src='"+a.data+"'></embed>")
break
case"view":case"browse":t=0==a.data.indexOf("http")?$("<iframe src='"+a.data+"'></iframe>"):$("<iframe src='"+a.data+"' srcdoc='"+a.data+"'></iframe>")
break
case"edit":case"inline":case"autoedit":t=$("<textarea>"),t.val(a.data),t.addClass("ckeditor"),"inline"==e.wHtmlViewerType?t.attr("decoration","no"):t.attr("decoration","yes")}return t},appx_session.createWidgetTag[WIDGET_TYPE_FLASH_PLAYER]=function(e,t){return $("<object data='http://www.w3schools.com/html/bookmark.swf'></object>")},appx_session.createWidgetTag[WIDGET_TYPE_MEDIA_PLAYER]=function(e,t){return"video"==e.type&&(t=$('<video><source src="http://www.w3schools.com/tags/movie.mp4" type="video/mp4">Your browser does not support the video tag.</video>')),"audio"==e.type&&(t=$('<audio controls><source src="http://www.w3schools.com/tags/horse.mp3" type="audio/mpeg">Your browser does not support the audio element.</audio>')),t},appx_session.createWidgetTag[WIDGET_TYPE_DATE_CHOOSER]=function(e,t,a,s){if(t=$("<div>").addClass("appxdatefield"),a.rawdata.length>0){s||(s=parseItemLongData(a.rawdata))
var o=parseItemDateData(s)
a.data=o.data,$(o.dv[0]).attr("id","appxitem_"+a.pos_col+"_"+a.pos_row),$(o.dv[0]).on("focus",function(){var e=getClientId($(this).attr("id")).split("_")
logca("item focus: "+e[1]+"."+e[2]),appxPutCursor(e[1],e[2]),$(this).select()}),t.append(o.dv),t.append(o.df)}return{tag:t,longdata:s}},appx_session.createWidgetTag[WIDGET_TYPE_TABLE]=function(e,t){for(var a,s,o=e.widgetData.split("@"),i="",l=e.wPositionY+"_"+e.wPositionX,n=0;n<o.length;n++)o[n].indexOf("SHS=")!==-1&&(a=o[n].substring(4)),o[n].indexOf("SFIK=")!==-1&&(s=o[n].substring(5)),o[n].indexOf("SPCB=")!==-1&&(i=o[n].substring(5))
var r=a+"_"+s+"_"+l
return t=$("<div>").addClass("appxtablewidget").attr("id",addClientId("appxitem_"+e.wPositionX+"_"+e.wPositionY+"_"+a+"_"+i,e.wClientId)).data("action",{command:e.wCommand,command2:e.wCommand2}).data("row",e.wPositionY).data("col",e.wPositionX).data("tableID",r).data("TCSV",e.tableShowCsvOption).data("TSPO",e.tableShowPageOption).data("TSCC",e.tableShowColChooser).data("TSLS",e.tableShowLayoutSave).data("TSTR",e.tableShowTableReset).data("TSTRF",e.tableShowTableRefresh).data("TSTS",e.tableShowTableSearch)},appx_session.createWidgetTag[WIDGET_TYPE_TEXT_AREA]=function(e,t,a){return t=$("<textarea>").css("padding","0"),appxSetModifiableCapable(a,!0),t.val(a.data.replace(/\<br \/\>|\<br\>|\<br\/\>/gi,"\r\n")),t},appx_session.createWidgetTag[WIDGET_TYPE_RAW_TEXT]=function(e,t,a){return appxIsDate(a)&&appxIsModifiable(a)?t=appxcreateformatitem(a):(a.size_rows>1?(t=$("<textarea>").css("padding","0"),appxIsWordWrap(a)||t.addClass("appx-alpha-field")):t=$("<input type='text'>"),appxSetModifiableCapable(a,!0),a.type==ELEM_LOG&&(a.data=appxLogicToAlpha(a.data)),appxIsMasked(a)||t.val(a.data.replace("\n"," \n"))),t},appx_session.createWidgetTag[WIDGET_TYPE_ROWTEXT]=function(e,t){return e.wPositionY>1&&(e.wLabel="<pre>"+e.wLabel+"</pre>",e.wColorFg="black",e.wFont="Dialog",t=$("<div>"),t.addClass("rowtext"),e.wLabel.length>1&&"="==e.wLabel[0]&&t.addClass("ColHdgSep"),t.attr("id",addClientId("widget_sac_"+e.wPositionX+"_"+e.wPositionY,e.wClientId))),t},appx_session.createWidgetTag[WIDGET_TYPE_SLIDER]=function(e,t,a){t=$("<div>"),t.addClass("noUiSlider")
var s=$("<div>").css({padding:"10px"}),o=$("<div>").addClass("slider")
return o.attr("data-value",parseInt(a.data)),o.attr("data-min",e.wMinValue),o.attr("data-max",e.wMaxValue),o.attr("data-tickMajor",e.wTickMajor),o.attr("data-tickMinor",e.wTickMinor),o.attr("data-tickShow",e.wPaintTicks),o.attr("data-tickLabels",e.wPaintTickLabels),o.attr("data-tickSnap",e.wSnapToTicks),o.attr("data-invert",e.wInvert),o.attr("data-modifiable",appxIsModifiable(a)),o.attr("data-orientation",e.wOrientation),$(s).append(o),t.append(s),t},appx_session.createWidgetTag[WIDGET_TYPE_FILE_CHOOSER]=function(e,t,a){var s=appxClientRoot+"/images/folder.png"
if(t=$("<input>"),appx_session.localConnectorRunning===!1&&e.fileUseLocalConnector===!0&&(s="",t.attr("placeholder","File chooser disabled, please type in file path/name.")),t.css({background:"#fff url("+s+") no-repeat",overflow:"hidden","background-position":"99% 50%",border:"double 1px #555","padding-right":"5px"}),t.addClass("appxfilewrapper"),t.val(a.data),e.fileUseLocalConnector===!1){$("#fileChooser").remove(),t.addClass("DULC")
var o
o="dir"===e.wDragAndDrop?$("<input type='file' webkitdirectory hidden>").css({border:"double 1px #555"}):$("<input type='file' hidden>").css({border:"double 1px #555"}),o.attr("id","fileChooser")
var i=t
o.change(function(e){$(this).parent("form").attr("action",$(this).parent("form").attr("action")+this.files[0].name)
var t=$(this)[0].files.length
t>1?i.val("Directory with "+t+" files."):i.val($(this)[0].files[0].name.replace(/\ /g,"_")),i.addClass("dirty"),$("#main").block({message:"<h1>Uploading file to temporary storage, please wait...</h1>",baseZ:999999,fadeIn:0}),appxReadBlob($(this).attr("id"))}),o.appendTo($("#main"))}return t},appx_session.createWidgetTag[WIDGET_TYPE_TOGGLE_BUTTON]=function(e,t,a){return t=$("<a>").addClass("togglebutton"),"1"==a.data&&t.addClass("down"),t.click(function(){"Chg"===$("#appx_status_mode").text()&&($(this).toggleClass("down"),$(this).addClass("dirty"))}),t},appx_session.createWidgetTag["default"]=function(e,t){return t=$("<button type='button'>").css({margin:"0",padding:"0"}),t.addClass("button").data("row",e.wPositionY).data("col",e.wPositionX),e.wLabel="ERROR: No Widget Type Defined for "+e.wLabel,e.wWidgetType=WIDGET_TYPE_ERROR,e.wBorder=BORDER_BEVEL_RAISED,e.size_col<40&&(e.size_col=40,e.wSizeW=40),e.size_row=3,e.wSizeH=3,t.val(e.wLabel),t.addClass("error"),{tag:t,widget:e}}}function createOptionOverride(){appx_session.optionOverride[20101]=function(){return showPopup(!1),!0},appx_session.optionOverride[20102]=function(){return propName="showOptionNumbers",propValue=!appx_session.getProp(propName),appx_session.setProp(propName,propValue.toString()),!1},appx_session.optionOverride[20103]=function(){return propName="autoTabOut",propValue=!appx_session.getProp(propName),appx_session.setProp(propName,propValue.toString()),!1},appx_session.optionOverride[20104]=function(){return propName="autoSelect",propValue=!appx_session.getProp(propName),appx_session.setProp(propName,propValue.toString()),!1},appx_session.optionOverride[20105]=function(){return!1},appx_session.optionOverride[20106]=function(){return showPopup(!1),!0},appx_session.optionOverride[20030]=function(){return showPopup(!1),!0},appx_session.optionOverride[20031]=function(){return showPopup(!0),!0},appx_session.optionOverride[20032]=function(){return appx_session.showPreferences(!1),!0},appx_session.optionOverride[21005]=function(){var e={}
return sendappxnewsession(appx_session.host,appx_session.port,appx_session.user,appx_session.password,appx_session.screenrows,appx_session.screencols,e),!0}}window.ondragover=function(e){return eventCatcher(e)},window.ondrop=function(e){return eventCatcher(e)},Widget.prototype.self=null
var ICON="appx-icon",ICON_LEADING="appx-icon-leading",ICON_TRAILING="appx-icon-trailing",ICON_NULL="appx-icon-null",ICON_BEHIND_TEXT="appx-icon-behind-text",ICON_ABOVE_TEXT="appx-icon-above-text",ICON_TRAILING_TEXT="appx-icon-trailing-text",ICON_BELOW_TEXT="appx-icon-below-text",ICON_LEADING_TEXT="appx-icon-leading-text",ICON_TRAILING_BOTTOM="appx-icon-trailing-bottom",ICON_LEADING_BOTTOM="appx-icon-leading-bottom",ICON_TRAILING_TOP="appx-icon-trailing-top",ICON_LEADING_TOP="appx-icon-leading-top",ICON_EXPAND_FILL="appx-icon-expand-fill",ICON_EXPAND_PROP="appx-icon-expand-prop",appxGetClassIcon=function(e,t){var a=parseInt(e.wWidgetType),s=a==WIDGET_TYPE_LABEL?ICON_TRAILING_TEXT:ICON_LEADING_TEXT
if(e.wTilingMode!=MODE_EXPAND&&e.wTilingMode!=MODE_TILE||t)switch(e.wSetHorizTextPos){case"LEFT":switch(e.wSetVertTextPos){case"BOTTOM":s=ICON_TRAILING_BOTTOM
break
case"TOP":s=ICON_TRAILING_TOP
break
default:s=ICON_TRAILING_TEXT}break
case"CENTER":switch(e.wSetVertTextPos){case"BOTTOM":s=ICON_ABOVE_TEXT
break
case"TOP":s=ICON_BELOW_TEXT
break
default:s=ICON_BEHIND_TEXT}break
default:switch(e.wSetVertTextPos){case"BOTTOM":s=ICON_LEADING_BOTTOM
break
case"TOP":s=ICON_LEADING_TOP
break
default:s=ICON_LEADING_TEXT}}else switch(e.wTilingMode){case MODE_EXPAND:s=ICON_EXPAND_FILL
break
case MODE_TILE:s=ICON_EXPAND_PROP
break
default:console.log("appxGetClassIcon: unhandled tiling "+e.wTilingMode)}return s},TEXT_NULL="appx-text-null",TEXT_CENTER="appx-text-center",TEXT_TOP="appx-text-top",TEXT_RIGHT="appx-text-right",TEXT_BOTTOM="appx-text-bottom",TEXT_LEFT="appx-text-left",TEXT_UPPER_RIGHT="appx-text-upper-right",TEXT_UPPER_LEFT="appx-text-upper-left",TEXT_LOWER_RIGHT="appx-text-lower-right",TEXT_LOWER_LEFT="appx-text-lower-left",appxGetClassText=function(e){var t=TEXT_LEFT
if(e.wSizeH&&e.wSizeH>1&&(t=e.wWidgetType==WIDGET_TYPE_RAW_TEXT?TEXT_UPPER_LEFT:TEXT_LEFT),e.wWidgetType==WIDGET_TYPE_HTML_VIEWER&&(t=TEXT_UPPER_LEFT),e.wWidgetType==WIDGET_TYPE_BUTTON&&(t=TEXT_CENTER),e.wWidgetType==WIDGET_TYPE_LABEL&&e.wSizeH>1){var a=checkBrowser()
"Edge"!=a&&"IE"!=a||(t=TEXT_NULL)}if(e.wSetHorizAlign||e.wSetVertAlign)switch(e.wSetHorizAlign){case"LEFT":switch(e.wSetVertAlign){case"BOTTOM":t=TEXT_LOWER_LEFT
break
case"TOP":t=TEXT_UPPER_LEFT
break
default:t=TEXT_LEFT}break
case"RIGHT":switch(e.wSetVertAlign){case"BOTTOM":t=TEXT_LOWER_RIGHT
break
case"TOP":t=TEXT_UPPER_RIGHT
break
default:t=TEXT_RIGHT}break
default:switch(e.wSetVertAlign){case"BOTTOM":t=TEXT_BOTTOM
break
case"TOP":t=TEXT_TOP
break
default:t=TEXT_CENTER}}return t}
Widget.prototype.parseAndSetShadow=function(e){try{var t=e.split(",")
t.length>0&&"F"==t[0].toUpperCase()?this.wSetDropShadow=!1:this.wSetDropShadow=!0,t.length>1&&t[1].length>0?this.wSetDropShadowDistance=parseInt(t[1]):this.wSetDropShadowDistance=25,t.length>2&&t[2].length>0?this.wSetDropShadowSize=parseInt(t[2]):this.wSetDropShadowSize=this.wSetDropShadowDistance,t.length>3&&t[3].length>0?this.wSetDropShadowAngle=parseInt(t[3]):this.wSetDropShadowAngle=45,t.length>4&&t[4].length>0?this.wSetDropShadowOpacity=.01*parseInt(t[4]):this.wSetDropShadowOpacity=.5,t.length>5&&t[5].length>0?this.wSetDropShadowColor=t[5]:this.wSetDropShadowColor="#000000"}catch(a){console.log("MWidget - bad setDropShadow "+a+","+e),console.log(a.stack)}},Widget.prototype.parseData=function(){try{if(this.widgetData)for(var e=null,t=this.parseDataIntoPairs(),a=0;a<t.length;a++){var s=t[a].key,o=t[a].value.replace(/ *$/,"").replace(/##\'\'##/g,'"')
switch(s){case"XA":var i=o.split(";"),l=[]
$.each(i,function(e,t){var a=t.split(":")
l.push(a)}),this.wExtraAttrs=l
break
case"CLSS":this.wClasses=o
break
case"CLID":this.wClientId=o
break
case"FULC":this.fileUseLocalConnector===!0&&(this.fileUseLocalConnector="T"==o)
break
case"SAA":break
case"SAC":this.wCommand=parseInt(o)
break
case"SAC2":this.wCommand2=parseInt(o)
break
case"SGFC":this.wCommandGotFocus=parseInt(o)
break
case"SLFC":this.wCommandLostFocus=parseInt(o)
break
case"SB":this.wBorder=parseInt(o)
break
case"SBN":this.wBoxNumber=parseInt(o)
break
case"SBP":"F"==o&&(this.wBorder=BORDER_NONE)
break
case"SCAF":this.wContentAreaFilled="F"!=o
break
case"SCT":this.wEndcapType=parseInt(o)
break
case"SDB":this.wDefaultButton="F"!=o
break
case"SDBC":o.length>7?(this.wColorBgDisabled=o.substr(0,7),this.wColorBgDisabledNL=parseInt("0x"+o.substr(7))/255):this.wColorBgDisabled=o
break
case"SDFC":o.length>7?(this.wColorFgDisabled=o.substr(0,7),this.wColorFgDisabledNL=parseInt("0x"+o.substr(7))/255):this.wColorFgDisabled=o
break
case"SDI":this.wIconDisabled=o
break
case"SDND":this.wDragAndDrop=o
break
case"SDS":this.parseAndSetShadow(o)
break
case"SE":this.wEnabled="F"!=o
break
case"SEBC":case"SBC":o.length>7?(this.wColorBg=o.substr(0,7),this.wColorBgNL=parseInt("0x"+o.substr(7))/255):(this.wColorBg=o,this.wColorBgNL=null)
break
case"SEFC":case"SFC":o.length>7?(this.wColorFg=o.substr(0,7),this.wColorFgNL=parseInt("0x"+o.substr(7))/255):(this.wColorFg=o,this.wColorFgNL=null)
break
case"SF":e=o.split(","),e.length>0&&(this.wFont=e[0]),e.length>1&&(this.wFontStyle=e[1].toLowerCase(),"bold+italic"!=this.wFontStyle&&"bold + italic"!=this.wFontStyle||(this.wFontStyle="bolditalic")),e.length>2&&(this.wFontSize=parseInt(e[2]),this.wFontSize>=presetFontSizes.length&&(this.wFontSize=0),this.wFontSize=presetFontSizes[this.wFontSize],this.wFontSizePercent=this.wFontSize,this.wWidgetType==WIDGET_TYPE_TABLE?this.wFontSize=.01*this.wFontSize*appx_session.colWidthPx*1.5+parseInt(appx_session.getProp("widgetFontAdjust")):this.wFontSize=.01*this.wFontSize*appx_session.colWidthPx*1.7+parseInt(appx_session.getProp("widgetFontAdjust")))
break
case"SFCM":this.wFileChooserMode=o
break
case"SFIK":this.wFrameImageKey=o
break
case"SGN":this.wGroupName=o
break
case"SHA":this.wSetHorizAlign=o
break
case"SHCL":this.wShowClose="F"!=o
break
case"SHHL":this.wShowHelp="F"!=o
break
case"SHL":this.specialHorizontalLocation=o
break
case"SHOK":this.wShowOk="F"!=o
break
case"SHS":this.wHashSig=parseInt(o)
break
case"SHTM":this.wHtmlViewerType=o
break
case"SHTP":this.wSetHorizTextPos=o
break
case"SI":this.wIconEnabled=o
break
case"SIG":this.wSignature="F"!=o
break
case"SINV":this.wInvert="F"!=o
break
case"SIS":var n=parseInt(o)
n>=presetFontSizes.length&&(n=0),n>0?this.wSetImageScale=parseInt(presetFontSizes[n]):console.log("MWidget.parseData() Invalid Widget Image Scale = "+o+"for widget = "+this.widgetData.toString())
break
case"SJE":this.wJevent=o
break
case"SJS":this.wJscript=o
break
case"SL":e=o.split(","),this.wPositionY=parseInt(e[1]),this.wPositionX=parseInt(e[0])
break
case"SLL":this.wLocalList=o
break
case"SLN":this.wLayer=parseInt(o)
break
case"SLUB":this.wLineUnitBase=o
break
case"SLW":this.wSetLineWeight=parseInt(o)
break
case"SM":e=o.split(","),e.length>0&&(this.wMarginT=parseInt(e[0])),e.length>1&&(this.wMarginL=parseInt(e[1])),e.length>2&&(this.wMarginB=parseInt(e[2])),e.length>3&&(this.wMarginR=parseInt(e[3]))
break
case"SMATS":this.wTickMajor=parseInt(o)
break
case"SMAX":this.wMaxValue=parseInt(o)
break
case"SMIN":this.wMinValue=parseInt(o)
break
case"SMITS":this.wTickMinor=parseInt(o)
break
case"SMN":this.wShortcut=o
break
case"SMT":this.wMenuNo=parseInt(o)
break
case"SMV":this.wMovable=!0,this.wMovableCommand=o
break
case"SMVC":this.wSetMoveCursor=!0
break
case"SO":"VERTICAL"===o?this.wOrientation="vertical":this.wOrientation="horizontal"
break
case"SOFF":e=o.split(","),e.length>0&&(this.wOffsetY=parseInt(e[0]),this.wOffsetY>127&&(this.wOffsetY=this.wOffsetY-256)),e.length>1&&(this.wOffsetX=parseInt(e[1]),this.wOffsetX>127&&(this.wOffsetX=this.wOffsetX-256)),e.length>2&&(this.wOffsetW=parseInt(e[2]),this.wOffsetW>127&&(this.wOffsetW=this.wOffsetW-256)),e.length>3&&(this.wOffsetH=parseInt(e[3]),this.wOffsetH>127&&(this.wOffsetH=this.wOffsetH-256))
break
case"SPCB":this.wPcbId=o
break
case"SPT":this.wPaintTicks="F"!=o
break
case"SPTL":this.wPaintTickLabels="F"!=o
break
case"SRBC":o.length>7?(this.wColorBgRollover=o.substr(0,7),this.wColorBgRolloverNL=parseInt("0x"+o.substr(7))/255):this.wColorBgRollover=o
break
case"SRE":this.wRolloverEnabled="F"!=o
break
case"SREC":this.wEditorConfig=o
break
case"SRFC":o.length>7?(this.wColorFgRollover=o.substr(0,7),this.wColorFgRolloverNL=parseInt("0x"+o.substr(7))/255):this.wColorFgRollover=o
break
case"SRI":this.wIconRollover=o
break
case"SSP":this.wStrokePattern=o
break
case"SSPO":this.wStrokePatternOffset=o
break
case"SST":this.wShortLabel=o
break
case"SSTT":this.wSnapToTicks="F"!=o
break
case"SSU":var r=parseInt(o);(r&WIDGET_SEP_BEFORE)==WIDGET_SEP_BEFORE&&(this.wSepBefore=!0),(r&WIDGET_SEP_AFTER)==WIDGET_SEP_AFTER&&(this.wSepAfter=!0)
break
case"SSZ":e=o.split(","),this.wSizeW=parseInt(e[0]),this.wSizeH=parseInt(e[1])
break
case"ST":this.wLabel=o
break
case"STG":this.wTabGroup=parseInt(o)
break
case"STM":this.wTilingMode=parseInt(o)
break
case"STSG":this.wTabSubGroupId=o
break
case"STTT":this.wTooltip=o
break
case"SV":this.wVisible="F"!=o
break
case"SVA":this.wSetVertAlign=o
break
case"SVAC":this.wCommandValueAdjusted=parseInt(o)
break
case"SVL":this.specialVerticalLocation=o
break
case"SVTP":this.wSetVertTextPos=o
break
case"SWBC":o.length>7?(this.wColorBgWallpaper=o.substr(0,7),this.wColorBgWallpaperNL=parseInt("0x"+o.substr(7))/255):this.wColorBgWallpaper=o
break
case"SWI":this.wIconWallpaper=o
break
case"SWID":this.wWidgetId=o
break
case"SWT":this.wWidgetType=parseInt(o)
break
case"SWU":var r=parseInt(o);(r&WIDGET_USAGE_MENU)==WIDGET_USAGE_MENU&&(this.wUsageMenu=!0),(r&WIDGET_USAGE_TOOLBAR)==WIDGET_USAGE_TOOLBAR&&(this.wUsageToolbar=!0),(r&WIDGET_USAGE_POPUP)==WIDGET_USAGE_POPUP&&(this.wUsagePopup=!0)
break
case"TSRN":this.tableShowRowNumbers="F"!=o
break
case"TSFB":this.tableShowFooterBar="F"!=o
break
case"TSHB":this.tableShowHeading="F"!=o
break
case"TCSS":this.tableCaseSort="T"==o
break
case"TCSV":this.tableShowCsvOption="T"==o
break
case"TSPO":this.tableShowPageOption="T"==o
break
case"TSCC":this.tableShowColChooser="T"==o
break
case"TSLS":this.tableShowLayoutSave="T"==o
break
case"TSTR":this.tableShowTableReset="T"==o
break
case"TSTRF":this.tableShowTableRefresh="T"==o
break
case"TSTS":this.tableShowTableSearch="T"==o
break
case"USE":this.wMenuUse="T"==o
break
case"TCS":this.tableColumnSortable="F"!=o
break
case"TCST":switch(o){case"INT":this.tableColumnSortType="int"
break
case"FLOAT":this.tableColumnSortType="float"
break
case"DATE":this.tableColumnSortType="date"
break
case"TEXT":this.tableColumnSortType="text"}break
case"TCR":this.tableColumnResizable="F"!=o
break
case"TCSE":this.tableColumnSearchable="F"!=o
break
case"TCDF":this.tableColumnDateFormat=o
break
case"TSMC":this.tableMovableColumn="F"!=o
break
case"ALTFC":this.wAltColorFg=o
break
case"ALTBC":this.wAltColorBg=o
break
default:console.log("WP: unhandled "+s+"="+o)}}if(this.wWidgetType==WIDGET_TYPE_TABLE&&(this.tableHashKey="pcb"+this.wPcbId+"fik"+this.wFrameImageKey+"sig"+this.wHashSig+"r"+this.wPositionY+"c"+this.wPositionX+"h"+this.wSizeH+"w"+this.wSizeW),null==this.wLayer&&(this.wLayer=10,null!=this.wWidgetType))switch(parseInt(this.wWidgetType)){case WIDGET_TYPE_LABEL:case WIDGET_TYPE_PICTURE:case WIDGET_TYPE_LINE:this.wLayer=20
break
case WIDGET_TYPE_TABLE:this.wLayer=9
break
case WIDGET_TYPE_BOX:this.wLayer=30
break
case WIDGET_TYPE_ROWTEXT:this.wLayer=25}}catch(p){console.log("Widget.parseData: "+p),console.log(p.stack)}},Widget.prototype.parseDataIntoPairs=function(){var e=[]
return void 0!=this.widgetData&&this.widgetData.length>0&&this.widgetData.replace(/[\n\r\t]/g,"").replace(/[@]([^@=a-z]*)[=]/g,"\n$1\t").split("\n").forEach(function(t){if(t.length>0){var a=t.split("\t")
2===a.length?e.push({key:a[0],value:a[1]}):console.log("Widget.parseDataIntoPairs() ERROR in macro: "+t)}}),e},appx_session.tableOptions=function(e,t,a,s,o){var i=$("#"+t),l=$("#"+a),n=$("<div title='"+appx_session.language.tooltips.tableOptions+"'>")
$("<div id='table-buttons-message-div'>").append("<span id='table-buttons-message-span'>").appendTo(n),n.appendTo(i),1==e.TSPO&&$("<button id='table-paging' class='table-buttons' title='"+appx_session.language.tooltips.tablePaging+"'>").click(function(){scrollSwitch(a,s,e,t)}).append($("<span class='table-buttons-span ui-icon ui-icon-newwin'>")).appendTo(n),1==e.TSTR&&$("<button id='table-reset' class='table-buttons' title='"+appx_session.language.tooltips.tableReset+"'>").click(function(){gridSetDefaults(a,s,e,t)}).append($("<span class='table-buttons-span ui-icon ui-icon-arrowreturn-1-s'>")).appendTo(n),1==e.TSCC&&$("<button id='table-column-chooser' class='table-buttons' title='"+appx_session.language.tooltips.tableColumns+"'>").click(function(){$("#"+a).jqGrid("columnChooser")}).append($("<span class='table-buttons-span ui-icon ui-icon-grid'>")).appendTo(n),1==e.TSLS&&$("<button id='table-save' class='table-buttons' title='"+appx_session.language.tooltips.tableSave+"'>").click(function(){var e={},t=l.getGridParam("colModel"),a=l.getGridParam("remapColumns")
"rn"===t[0].name?(e.colModel=t.slice(2),e.colMap=a.slice(0,a.length-2)):(e.colModel=t.slice(1),e.colMap=a.slice(0,a.length-1)),e.filters=l.getGridParam("postData").filters,e.lastSortName=l.getGridParam("postData").lastSortName,e.lastSortOrder=l.getGridParam("postData").lastSortOrder,e.selected=l.getGridParam("selarrrow"),e.virtualScroll=l.getGridParam("scroll"),e.scrollTop=l.closest(".ui-jqgrid-bdiv").scrollTop(),e.tableID=i.data("tableID"),e.tableHash=i.data("tableHashKey"),tableToMongo(e,!0),$("#table-buttons-message-span").text(appx_session.language.tooltips.tableSaved)}).append($("<span class='table-buttons-span ui-icon ui-icon-disk'>")).appendTo(n),n.dialog({open:function(e,t){$(this).parent().css({"z-index":19999,width:"325px"}),$(this).css({"z-index":19999,width:"98%"}),$(".ui-dialog :button").blur()},close:function(){$(this).dialog("destroy").remove(),$("#table_options_button").blur()},buttons:{Finished:function(e){var t=$("table.ui-jqgrid-btable").attr("id").substring($("table.ui-jqgrid-btable").attr("id").indexOf("_")+1),a=$($("table.ui-jqgrid-btable")).getGridParam("colModel"),s=$($("table.ui-jqgrid-btable")).getGridParam("remapColumns")
"rn"===a[0].name?(appx_session.currenttabledata[t].colModel=a.slice(2),appx_session.currenttabledata[t].colMap=s.slice(0,s.length-2)):(appx_session.currenttabledata[t].colModel=a.slice(1),appx_session.currenttabledata[t].colMap=s.slice(0,s.length-1)),$(this).dialog("close")}}})}
const presetFontSizes=[100,25,33,50,66,75,80,85,90,95,100,105,110,115,120,125,130,140,150,175,200,300,400,500,600,700,800,900,1e3],BORDER_NONE=5,BORDER_SIMPLE_LINE=10,BORDER_SIMPLE_LINE_WIDER=20,BORDER_ETCHED_SUNKEN=30,BORDER_ETCHED_RAISED=40,BORDER_BEVEL_SUNKEN=50,BORDER_BEVEL_RAISED=60,BORDER_SOFT_BEVEL_SUNKEN=70,BORDER_SOFT_BEVEL_RAISED=80,BORDER_IMAGE_EDITOR=90,BORDER_MAX=BORDER_IMAGE_EDITOR,MODE_TILE=1,MODE_EXPAND=2,MODE_CENTER=3,MODE_N=4,MODE_E=5,MODE_S=6,MODE_W=7,MODE_NE=8,MODE_NW=9,MODE_SE=10,MODE_SW=11,TOKENIZE_WIDGET_TYPE_BUTTON=1,TOKENIZE_WIDGET_TYPE_MENU=2,TOKENIZE_WIDGET_TYPE_MENUHDR=3,TOKENIZE_WIDGET_TYPE_BOX=4,TOKENIZE_WIDGET_TYPE_ITM=5,WIDGET_PRNT_TYPE_FRAME=2,WIDGET_PRNT_TYPE_IMAGE=3,WIDGET_PRNT_TYPE_ITEM=5,WIDGET_PRNT_TYPE_WIDGET=6,WIDGET_PRNT_TYPE_CHILD=8,WIDGET_SEP_BEFORE=1,WIDGET_SEP_AFTER=2,WIDGET_TYPE_NONE=0,WIDGET_TYPE_BUTTON=1,WIDGET_TYPE_LABEL=2,WIDGET_TYPE_PICTURE=3,WIDGET_TYPE_BOX=4,WIDGET_TYPE_LINE=5,WIDGET_TYPE_RAW_TEXT=20,X_WIDGET_TYPE_SPINNER=30,WIDGET_TYPE_SLIDER=31,X_WIDGET_TYPE_RADIO_DIAL=32,WIDGET_TYPE_PROGRESS_BAR=33,X_WIDGET_TYPE_SCROLL_BAR=34,WIDGET_TYPE_CHECK_BOX=40,X_WIDGET_TYPE_RADIO_BUTTON=41,WIDGET_TYPE_LISTBOX=42,WIDGET_TYPE_TOGGLE_BUTTON=43,WIDGET_TYPE_PASSWORD=50,WIDGET_TYPE_FILE_CHOOSER=51,WIDGET_TYPE_COLOR_CHOOSER=52,WIDGET_TYPE_TEXT_AREA=59,WIDGET_TYPE_HTML_VIEWER=60,X_WIDGET_TYPE_RTF_VIEWER=61,X_WIDGET_TYPE_CODE_VIEWER=62,WIDGET_TYPE_HTML_EDITOR=63,WIDGET_TYPE_FLASH_PLAYER=64,WIDGET_TYPE_MEDIA_PLAYER=65,X_WIDGET_TYPE_WEB_BROWSER=66,X_WIDGET_TYPE_BUTTON_GROUP=70,WIDGET_TYPE_DATE_CHOOSER=80,WIDGET_TYPE_TABLE=90,WIDGET_TYPE_ROWTEXT=91,WIDGET_TYPE_IMG_EDITOR_FRAME=200,WIDGET_TYPE_ILF_EDITOR_FRAME=201,WIDGET_TYPE_PRT_ON_SCR_FRAME=202,WIDGET_TYPE_ERROR=8899,WIDGET_USAGE_MENU=1,WIDGET_USAGE_TOOLBAR=2,WIDGET_USAGE_POPUP=4
createWidgetTagObject(),createOptionOverride()
